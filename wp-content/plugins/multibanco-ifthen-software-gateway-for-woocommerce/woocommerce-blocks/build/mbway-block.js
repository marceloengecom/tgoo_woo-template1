(()=>{"use strict";const e=window.wc.wcBlocksRegistry,t=window.wp.i18n,n=window.wc.wcSettings,o=window.wp.htmlEntities,c=window.React,a=window.wp.hooks,i=(0,n.getSetting)("mbway_ifthen_for_woocommerce_data",{}),r=(0,t.__)("MB WAY mobile payment","multibanco-ifthen-software-gateway-for-woocommerce")+" (ifthenpay)",l=(0,o.decodeEntities)(i.title)||r,s=e=>{const[n,r]=(0,c.useState)(i.default_number),[l,s]=(0,c.useState)(i.default_country_code),{eventRegistration:m,emitResponse:p}=e,{onPaymentSetup:u}=m;(0,c.useEffect)((()=>{const e=u((async()=>{const e=n,o=l;return i.allow_international&&"PT"!==o||9===e.length&&"9"===e.charAt(0)?{type:p.responseTypes.SUCCESS,meta:{paymentMethodData:(0,a.applyFilters)("mbway_ifthen_blocks_checkout_payment_data",{mbway_ifthen_for_woocommerce_phone:e,mbway_ifthen_for_woocommerce_country_code:o})}}:{type:p.responseTypes.ERROR,message:(0,t.__)("Invalid MB WAY phone number","multibanco-ifthen-software-gateway-for-woocommerce")}}));return()=>{e()}}),[p.responseTypes.ERROR,p.responseTypes.SUCCESS,u,n,l]);const _=e=>{const t=e.target.value;s(t);const n=document.getElementById(i.id+"_phone");n&&(n.maxLength="PT"===t?9:99)};var d=React.createElement("p",null,(0,o.decodeEntities)(i.description||""));if(i.allow_international){const e=i.country_code_options&&"object"==typeof i.country_code_options?Object.entries(i.country_code_options).map((([e,t])=>({code:e,display:t.display}))):[{code:"PT",value:"+351",display:"Portugal (+351)"}];var w=React.createElement("select",{name:i.id+"_country_code",id:i.id+"_country_code",className:"wc-blocks-components-select__select",options:e,required:!0,value:l,onChange:_},e.map((e=>React.createElement("option",{key:e.code,value:e.code},e.display))));if("PT"===i.default_country_code)var y="9";else y="99"}else w=null,y="9";var h=React.createElement("input",{type:"tel",name:i.id+"_phone",id:i.id+"_phone",placeholder:"9xxxxxxxx",autoComplete:"off",maxLength:y,required:!0,value:n,onChange:e=>{const t=e.target.value.replace(/\D/g,"");r(t)}}),f=React.createElement("label",{htmlFor:i.id+"_phone"},(0,o.decodeEntities)(i.phonenumbertext||"")),b=(0,a.applyFilters)("mbway_ifthen_blocks_checkout_before_phone_number",null);if(i.allow_international){var g=React.createElement("label",{htmlFor:i.id+"_country_code",className:"wc-blocks-components-select__label"},(0,t.__)("Country code","multibanco-ifthen-software-gateway-for-woocommerce")),E=React.createElement("div",{className:"wc-blocks-components-select__container"},"",g,w);E=React.createElement("div",{className:"wc-blocks-components-select"},"",E)}else E=null;var R=React.createElement("div",{className:"wc-block-components-text-input is-active"},"",h,f),v=(0,a.applyFilters)("mbway_ifthen_blocks_checkout_after_phone_number",null);if(E)var x="\n\t\t\t.mbway-ifthen-for-woocommerce-instructions-container {\n\t\t\t\tcontainer-type: inline-size;\n\t\t\t\tcontainer-name: mbway-ifthen-instructions-container;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-wrap: wrap;\n\t\t\t\tgap: 0 16px;\n\t\t\t\tjustify-content: space-between;\n\n\t\t\t}\n\t\t\t.mbway-ifthen-for-woocommerce-instructions-container > * {\n\t\t\t\tflex: 0 0 100%;\n\t\t\t}\n\t\t\t.mbway-ifthen-for-woocommerce-instructions-container > :nth-child(2) { /* instructions */\n\t\t\t\tmargin-bottom: 0px;\n\t\t\t}\n\t\t\t@container mbway-ifthen-instructions-container ( min-width: 450px ) {\n\t\t\t\t.mbway-ifthen-for-woocommerce-instructions-container > :nth-child(3), /* country code */\n\t\t\t\t.mbway-ifthen-for-woocommerce-instructions-container > :nth-child(4) { /* phone number */\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t\tflex: 1 0 calc( 50% - 12px );\n\t\t\t\t}\n\t\t\t}\n\t\t";else x="";const k=React.createElement("style",null,x);return React.createElement("div",{className:"mbway-ifthen-for-woocommerce-instructions-container"},k,d,b,E,R,v)},m={name:"mbway_ifthen_for_woocommerce",label:React.createElement((e=>{var t=React.createElement("img",{src:i.icon,width:i.icon_width,height:i.icon_height,style:{display:"inline"}});return React.createElement("span",{className:"wc-block-components-payment-method-label wc-block-components-payment-method-label--with-icon"},t,(0,o.decodeEntities)(i.title)||r)}),null),content:React.createElement(s,null),edit:React.createElement(s,null),icons:null,canMakePayment:e=>{if("EUR"!=e.cartTotals.currency_code)return!1;if(i.only_portugal&&"PT"!=e.billingData.country&&"PT"!=e.shippingAddress.country)return!1;var t=e.cartTotals.total_price/100;return!(i.only_above&&t<i.only_above||i.only_bellow&&t>i.only_bellow)},ariaLabel:l,supports:{features:i.supports}};(0,e.registerPaymentMethod)(m)})();